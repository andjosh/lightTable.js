/*! lightTable.js v1.0.0 */
/*! By Joshua Beckman <@jbckmn>, 28-01-2014 */
/*! Repo: git@github.com:jbckmn/lightTable.js.git, License: MIT */
!function(a,b){a.lightTable=a.lightTable||{getPalette:function(a,b,e){"undefined"==typeof b&&(b=10),"undefined"==typeof e&&(e=10);for(var f,g,h,i,j,k=new d(a),l=k.getImageData(),m=l.data,n=k.getPixelCount(),o=[],p=0;n>p;p+=e)f=4*p,g=m[f+0],h=m[f+1],i=m[f+2],j=m[f+3],j>=125&&(g>250&&h>250&&i>250||o.push([g,h,i]));var q=c.quantize(o,b),r=q.palette();return k.removeCanvas(),r},getEXIF:function(){function b(a){return!!a.exifdata}function c(b,c){function g(a){var e=d(a);b.exifdata=e||{},c&&c.call(b)}if(b instanceof Image)f(b.src,function(a){g(a.binaryResponse)});else if(a.FileReader&&b instanceof a.File){var h=new FileReader;h.onload=function(a){g(new e(a.target.result))},h.readAsBinaryString(b)}}function d(a){if(255!=a.getByteAt(0)||216!=a.getByteAt(1))return!1;for(var b,c=2,d=a.getLength();d>c;){if(255!=a.getByteAt(c))return o&&console.log("Not a valid marker at offset "+c+", found: "+a.getByteAt(c)),!1;if(b=a.getByteAt(c+1),22400==b)return o&&console.log("Found 0xFFE1 marker"),i(a,c+4,a.getShortAt(c+2,!0)-2);if(225==b)return o&&console.log("Found 0xFFE1 marker"),i(a,c+4,a.getShortAt(c+2,!0)-2);c+=2+a.getShortAt(c+2,!0)}}function g(a,b,c,d,e){var f,g,i,j=a.getShortAt(c,e),k={};for(i=0;j>i;i++)f=c+12*i+2,g=d[a.getShortAt(f,e)],!g&&o&&console.log("Unknown tag: "+a.getShortAt(f,e)),k[g]=h(a,f,b,c,e);return k}function h(a,b,c,d,e){var f,g,h,i,j,k,l=a.getShortAt(b+2,e),m=a.getLongAt(b+4,e),n=a.getLongAt(b+8,e)+c;switch(l){case 1:case 7:if(1==m)return a.getByteAt(b+8,e);for(f=m>4?n:b+8,g=[],i=0;m>i;i++)g[i]=a.getByteAt(f+i);return g;case 2:return f=m>4?n:b+8,a.getStringAt(f,m-1);case 3:if(1==m)return a.getShortAt(b+8,e);for(f=m>2?n:b+8,g=[],i=0;m>i;i++)g[i]=a.getShortAt(f+2*i,e);return g;case 4:if(1==m)return a.getLongAt(b+8,e);for(g=[],i=0;m>i;i++)g[i]=a.getLongAt(n+4*i,e);return g;case 5:if(1==m)return j=a.getLongAt(n,e),k=a.getLongAt(n+4,e),h=new Number(j/k),h.numerator=j,h.denominator=k,h;for(g=[],i=0;m>i;i++)j=a.getLongAt(n+8*i,e),k=a.getLongAt(n+4+8*i,e),g[i]=new Number(j/k),g[i].numerator=j,g[i].denominator=k;return g;case 9:if(1==m)return a.getSLongAt(b+8,e);for(g=[],i=0;m>i;i++)g[i]=a.getSLongAt(n+4*i,e);return g;case 10:if(1==m)return a.getSLongAt(n,e)/a.getSLongAt(n+4,e);for(g=[],i=0;m>i;i++)g[i]=a.getSLongAt(n+8*i,e)/a.getSLongAt(n+4+8*i,e);return g}}function i(a,b){if("Exif"!=a.getStringAt(b,4))return o&&console.log("Not valid EXIF data! "+a.getStringAt(b,4)),!1;var c,d,e,f,h,i=b+6;if(18761==a.getShortAt(i))c=!1;else{if(19789!=a.getShortAt(i))return o&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;c=!0}if(42!=a.getShortAt(i+2,c))return o&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(8!=a.getLongAt(i+4,c))return o&&console.log("Not valid TIFF data! (First offset not 8)",a.getShortAt(i+4,c)),!1;if(d=g(a,i,i+8,q,c),d.ExifIFDPointer){f=g(a,i,i+d.ExifIFDPointer,p,c);for(e in f){switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":f[e]=s[e][f[e]];break;case"ExifVersion":case"FlashpixVersion":f[e]=String.fromCharCode(f[e][0],f[e][1],f[e][2],f[e][3]);break;case"ComponentsConfiguration":f[e]=s.Components[f[e][0]]+s.Components[f[e][1]]+s.Components[f[e][2]]+s.Components[f[e][3]]}d[e]=f[e]}}if(d.GPSInfoIFDPointer){h=g(a,i,i+d.GPSInfoIFDPointer,r,c);for(e in h){switch(e){case"GPSVersionID":h[e]=h[e][0]+"."+h[e][1]+"."+h[e][2]+"."+h[e][3]}d[e]=h[e]}}return d}function j(a,d){return a instanceof Image&&!a.complete?!1:(b(a)?d&&d.call(a):c(a,d),!0)}function k(a,c){return b(a)?a.exifdata[c]:void 0}function l(a){if(!b(a))return{};var c,d=a.exifdata,e={};for(c in d)d.hasOwnProperty(c)&&(e[c]=d[c]);return e}function m(a){if(!b(a))return"";var c,d=a.exifdata,e="";for(c in d)d.hasOwnProperty(c)&&(e+="object"==typeof d[c]?d[c]instanceof Number?c+" : "+d[c]+" ["+d[c].numerator+"/"+d[c].denominator+"]\r\n":c+" : ["+d[c].length+" values]\r\n":c+" : "+d[c]+"\r\n");return e}function n(a){return d(a)}var o=!1,p={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},q={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},r={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},s={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};return{readFromBinaryFile:n,pretty:m,tag:k,allTags:l,data:j,Tags:p,TiffTags:q,GPSTags:r,StringValues:s}}(),getIPTC:function(b,c){function d(a){return!!a.exifdata}function g(b,c){function d(a){var b=i(a);iptcData=b||{},c&&c.call(iptcData)}if(b instanceof Image)f(b.src,function(a){d(a.binaryResponse)});else if(a.FileReader&&b instanceof a.File){var g=new FileReader;g.onload=function(a){d(new e(a.target.result))},g.readAsBinaryString(b)}}function h(a,b,c){var d={};if("Photoshop"!=a.getStringAt(b,9))return j&&log("Not valid Photoshop data! "+a.getStringAt(b,9)),!1;for(var e,f,g,h,i,l=a.getLength(),m=28,n=2,o=0;c>o;o++)if(g=b+o,a.getByteAt(g)==n&&a.getByteAt(g+1)in k){for(e=0,f=2;l>g+f&&a.getByteAt(g+f)!=m&&a.getByteAt(g+f+1)!=n;)f++,e++;if(!e)continue;h=k[a.getByteAt(g+1)],i=a.getStringAt(b+o+2,e)||"",i=i.replace("\x00","").trim(),d[h]=i,o+=e-1}return d}function i(a){if(255!=a.getByteAt(0)||216!=a.getByteAt(1))return!1;for(var b=2,c=a.getLength();c>b;){if(255!=a.getByteAt(b))return j&&console.log("Not a valid marker at offset "+b+", found: "+a.getByteAt(b)),!1;var d=a.getByteAt(b+1);if(237==d)return j&&console.log("Found 0xFFED marker"),h(a,b+4,a.getShortAt(b+2,!0)-2);b+=2+a.getShortAt(b+2,!0)}}var j=!1,k={120:"caption",110:"credit",25:"keywords",85:"byline",122:"captionWriter",105:"headline",116:"copyright",15:"category"};return b instanceof Image&&!b.complete?!1:void(d(b)?c&&c.call(b):g(b,c))}};var c=function(){function a(a,b,c){return(a<<2*j)+(b<<j)+c}function b(a){function b(){c.sort(a),d=!0}var c=[],d=!1;return{push:function(a){c.push(a),d=!1},peek:function(a){return d||b(),void 0===a&&(a=c.length-1),c[a]},pop:function(){return d||b(),c.pop()},size:function(){return c.length},map:function(a){return c.map(a)},debug:function(){return d||b(),c}}}function c(a,b,c,d,e,f,g){var h=this;h.r1=a,h.r2=b,h.g1=c,h.g2=d,h.b1=e,h.b2=f,h.histo=g}function d(){this.vboxes=new b(function(a,b){return i.naturalOrder(a.vbox.count()*a.vbox.volume(),b.vbox.count()*b.vbox.volume())})}function e(b){var c,d,e,f,g=1<<3*j,h=new Array(g);return b.forEach(function(b){d=b[0]>>k,e=b[1]>>k,f=b[2]>>k,c=a(d,e,f),h[c]=(h[c]||0)+1}),h}function f(a,b){var d,e,f,g=1e6,h=0,i=1e6,j=0,l=1e6,m=0;return a.forEach(function(a){d=a[0]>>k,e=a[1]>>k,f=a[2]>>k,g>d?g=d:d>h&&(h=d),i>e?i=e:e>j&&(j=e),l>f?l=f:f>m&&(m=f)}),new c(g,h,i,j,l,m,b)}function g(b,c){function d(a){var b,d,e,f,g,h=a+"1",i=a+"2",k=0;for(j=c[h];j<=c[i];j++)if(p[j]>o/2){for(e=c.copy(),f=c.copy(),b=j-c[h],d=c[i]-j,g=d>=b?Math.min(c[i]-1,~~(j+d/2)):Math.max(c[h],~~(j-1-b/2));!p[g];)g++;for(k=q[g];!k&&p[g-1];)k=q[--g];return e[i]=g,f[h]=e[i]+1,[e,f]}}if(c.count()){var e=c.r2-c.r1+1,f=c.g2-c.g1+1,g=c.b2-c.b1+1,h=i.max([e,f,g]);if(1==c.count())return[c.copy()];var j,k,l,m,n,o=0,p=[],q=[];if(h==e)for(j=c.r1;j<=c.r2;j++){for(m=0,k=c.g1;k<=c.g2;k++)for(l=c.b1;l<=c.b2;l++)n=a(j,k,l),m+=b[n]||0;o+=m,p[j]=o}else if(h==f)for(j=c.g1;j<=c.g2;j++){for(m=0,k=c.r1;k<=c.r2;k++)for(l=c.b1;l<=c.b2;l++)n=a(k,j,l),m+=b[n]||0;o+=m,p[j]=o}else for(j=c.b1;j<=c.b2;j++){for(m=0,k=c.r1;k<=c.r2;k++)for(l=c.g1;l<=c.g2;l++)n=a(k,l,j),m+=b[n]||0;o+=m,p[j]=o}return p.forEach(function(a,b){q[b]=o-a}),d(h==e?"r":h==f?"g":"b")}}function h(a,c){function h(a,b){for(var c,d=1,e=0;l>e;)if(c=a.pop(),c.count()){var f=g(j,c),h=f[0],i=f[1];if(!h)return;if(a.push(h),i&&(a.push(i),d++),d>=b)return;if(e++>l)return}else a.push(c),e++}if(!a.length||2>c||c>256)return!1;var j=e(a),k=0;j.forEach(function(){k++});var n=f(a,j),o=new b(function(a,b){return i.naturalOrder(a.count(),b.count())});o.push(n),h(o,m*c);for(var p=new b(function(a,b){return i.naturalOrder(a.count()*a.volume(),b.count()*b.volume())});o.size();)p.push(o.pop());h(p,c-p.size());for(var q=new d;p.size();)q.push(p.pop());return q}var i={map:function(a,b){var c={};return b?a.map(function(a,d){return c.index=d,b.call(c,a)}):a.slice()},naturalOrder:function(a,b){return b>a?-1:a>b?1:0},sum:function(a,b){var c={};return a.reduce(b?function(a,d,e){return c.index=e,a+b.call(c,d)}:function(a,b){return a+b},0)},max:function(a,b){return Math.max.apply(null,b?i.map(a,b):a)}},j=5,k=8-j,l=1e3,m=.75;return c.prototype={volume:function(a){var b=this;return(!b._volume||a)&&(b._volume=(b.r2-b.r1+1)*(b.g2-b.g1+1)*(b.b2-b.b1+1)),b._volume},count:function(b){var c=this,d=c.histo;if(!c._count_set||b){var e,f,g,h=0;for(e=c.r1;e<=c.r2;e++)for(f=c.g1;f<=c.g2;f++)for(g=c.b1;g<=c.b2;g++)index=a(e,f,g),h+=d[index]||0;c._count=h,c._count_set=!0}return c._count},copy:function(){var a=this;return new c(a.r1,a.r2,a.g1,a.g2,a.b1,a.b2,a.histo)},avg:function(b){var c=this,d=c.histo;if(!c._avg||b){var e,f,g,h,i,k=0,l=1<<8-j,m=0,n=0,o=0;for(f=c.r1;f<=c.r2;f++)for(g=c.g1;g<=c.g2;g++)for(h=c.b1;h<=c.b2;h++)i=a(f,g,h),e=d[i]||0,k+=e,m+=e*(f+.5)*l,n+=e*(g+.5)*l,o+=e*(h+.5)*l;c._avg=k?[~~(m/k),~~(n/k),~~(o/k)]:[~~(l*(c.r1+c.r2+1)/2),~~(l*(c.g1+c.g2+1)/2),~~(l*(c.b1+c.b2+1)/2)]}return c._avg},contains:function(a){var b=this,c=a[0]>>k;return gval=a[1]>>k,bval=a[2]>>k,c>=b.r1&&c<=b.r2&&gval>=b.g1&&gval<=b.g2&&bval>=b.b1&&bval<=b.b2}},d.prototype={push:function(a){this.vboxes.push({vbox:a,color:a.avg()})},palette:function(){return this.vboxes.map(function(a){return a.color})},size:function(){return this.vboxes.size()},map:function(a){for(var b=this.vboxes,c=0;c<b.size();c++)if(b.peek(c).vbox.contains(a))return b.peek(c).color;return this.nearest(a)},nearest:function(a){for(var b,c,d,e=this.vboxes,f=0;f<e.size();f++)c=Math.sqrt(Math.pow(a[0]-e.peek(f).color[0],2)+Math.pow(a[1]-e.peek(f).color[1],2)+Math.pow(a[2]-e.peek(f).color[2],2)),(b>c||void 0===b)&&(b=c,d=e.peek(f).color);return d},forcebw:function(){var a=this.vboxes;a.sort(function(a,b){return i.naturalOrder(i.sum(a.color),i.sum(b.color))});var b=a[0].color;b[0]<5&&b[1]<5&&b[2]<5&&(a[0].color=[0,0,0]);var c=a.length-1,d=a[c].color;d[0]>251&&d[1]>251&&d[2]>251&&(a[c].color=[255,255,255])}},{quantize:h}}(),d=function(a){this.canvas=b.createElement("canvas"),this.context=this.canvas.getContext("2d"),b.body.appendChild(this.canvas),this.width=this.canvas.width=a.width,this.height=this.canvas.height=a.height,this.context.drawImage(a,0,0,this.width,this.height)};d.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},d.prototype.update=function(a){this.context.putImageData(a,0,0)},d.prototype.getPixelCount=function(){return this.width*this.height},d.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},d.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var e=function(b,c,d){var e=b,f=c||0,g=0;this.getRawData=function(){return e},"string"==typeof b?(g=d||e.length,this.getByteAt=function(a){return 255&e.charCodeAt(a+f)},this.getBytesAt=function(a,b){for(var c=[],d=0;b>d;d++)c[d]=255&e.charCodeAt(a+d+f);return c}):"unknown"==typeof b&&(g=d||IEBinary_getLength(e),this.getByteAt=function(a){return IEBinary_getByteAt(e,a+f)},this.getBytesAt=function(a,b){return new VBArray(IEBinary_getBytesAt(e,a+f,b)).toArray()}),this.getLength=function(){return g},this.getSByteAt=function(a){var b=this.getByteAt(a);return b>127?b-256:b},this.getShortAt=function(a,b){var c=b?(this.getByteAt(a)<<8)+this.getByteAt(a+1):(this.getByteAt(a+1)<<8)+this.getByteAt(a);return 0>c&&(c+=65536),c},this.getSShortAt=function(a,b){var c=this.getShortAt(a,b);return c>32767?c-65536:c},this.getLongAt=function(a,b){var c=this.getByteAt(a),d=this.getByteAt(a+1),e=this.getByteAt(a+2),f=this.getByteAt(a+3),g=b?(((c<<8)+d<<8)+e<<8)+f:(((f<<8)+e<<8)+d<<8)+c;return 0>g&&(g+=4294967296),g},this.getSLongAt=function(a,b){var c=this.getLongAt(a,b);return c>2147483647?c-4294967296:c},this.getStringAt=function(a,b){for(var c=[],d=this.getBytesAt(a,b),e=0;b>e;e++)c[e]=String.fromCharCode(d[e]);return c.join("")},this.getCharAt=function(a){return String.fromCharCode(this.getByteAt(a))},this.toBase64=function(){return a.btoa(e)},this.fromBase64=function(b){e=a.atob(b)}},f=function(){function b(){var b=null;return a.ActiveXObject?b=new ActiveXObject("Microsoft.XMLHTTP"):a.XMLHttpRequest&&(b=new XMLHttpRequest),b}function c(a,c,d){var e=b();e?(c&&("undefined"!=typeof e.onload?e.onload=function(){"200"==e.status?c(this):d&&d(),e=null}:e.onreadystatechange=function(){4==e.readyState&&("200"==e.status?c(this):d&&d(),e=null)}),e.open("HEAD",a,!0),e.send(null)):d&&d()}function d(a,c,d,f,g,h){var i=b();if(i){var j=0;f&&!g&&(j=f[0]);var k=0;f&&(k=f[1]-f[0]+1),c&&("undefined"!=typeof i.onload?i.onload=function(){"200"==i.status||"206"==i.status||"0"==i.status?(i.binaryResponse=new e(i.responseText,j,k),i.fileSize=h||i.getResponseHeader("Content-Length"),c(i)):d&&d(),i=null}:i.onreadystatechange=function(){if(4==i.readyState){if("200"==i.status||"206"==i.status||"0"==i.status){var a={status:i.status,binaryResponse:new e("unknown"==typeof i.responseBody?i.responseBody:i.responseText,j,k),fileSize:h||i.getResponseHeader("Content-Length")};c(a)}else d&&d();i=null}}),i.open("GET",a,!0),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),f&&g&&i.setRequestHeader("Range","bytes="+f[0]+"-"+f[1]),i.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT"),i.send(null)}else d&&d()}return function(a,b,e,f){f?c(a,function(c){var g,h,i=parseInt(c.getResponseHeader("Content-Length"),10),j=c.getResponseHeader("Accept-Ranges");g=f[0],f[0]<0&&(g+=i),h=g+f[1]-1,d(a,b,e,[g,h],"bytes"==j,i)}):d(a,b,e)}}();b.write(["<script type='text/vbscript'>\r\n","Function IEBinary_getByteAt(strBinary, iOffset)\r\n"," IEBinary_getByteAt = AscB(MidB(strBinary, iOffset + 1, 1))\r\n","End Function\r\n","Function IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n","  Dim aBytes()\r\n","  ReDim aBytes(iLength - 1)\r\n","  For i = 0 To iLength - 1\r\n","   aBytes(i) = IEBinary_getByteAt(strBinary, iOffset + i)\r\n","  Next\r\n","  IEBinary_getBytesAt = aBytes\r\n","End Function\r\n","Function IEBinary_getLength(strBinary)\r\n"," IEBinary_getLength = LenB(strBinary)\r\n","End Function\r\n","</script>\r\n"].join(""))}(this,this.document);